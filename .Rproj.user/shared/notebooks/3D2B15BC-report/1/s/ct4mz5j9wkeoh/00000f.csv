"0","# creates a sequence of x values for prediction"
"0","pred <- samples_df %>%"
"0","  full_join(data.frame(x = seq(0, 100, by = 1)), by = character()) %>%"
"0","  mutate("
"0","    mu = beta1 + beta2 * x,"
"0","    sigma = sqrt(beta3 + beta4 * x^2),"
"0","    weight = exp(log_weights)"
"0","  ) %>%"
"0","  group_by(x) %>%"
"0","  summarise("
"0","    mu_pred = sum(weight * mu),"
"0","    sigma_pred = sqrt(sum(weight * (sigma^2 + (mu - mu_pred)^2))),"
"0","    .groups = ""drop"""
"0","  )"
"0",""
"0","# Plotting the prediction intervals"
"0","ggplot() +"
"0","  geom_point(data = filament1, aes(x = CAD_Weight, y = Actual_Weight)) +"
"0","  geom_line(data = pred, aes(x = x, y = mu_pred)) +"
"0","  geom_ribbon(data = pred, aes(x = x, ymin = mu_pred - 2 * sigma_pred, ymax = mu_pred + 2 * sigma_pred), alpha = 0.2, inherit.aes = FALSE) +"
"0","  labs(x = ""CAD weight"", y = ""Actual weight"", title = ""Scatter plot with regression line and prediction intervals"") +"
"0","  theme_minimal()"
